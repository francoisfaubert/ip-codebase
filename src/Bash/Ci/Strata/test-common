#!/usr/bin/env bash


BIN_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
ROOT_DIR="$( dirname "$BIN_DIR")"

if [[ ! -f $ROOT_DIR/vendor/iprospect_ca/ip-codebase/src/Bash/Ci/Strata/build-common ]] ; then
    echo "[build] [FAIL] Default build script could not be found.\n"
    exit 500
else
    echo "[build] [ OK ] Found common build script. Invoking command..\n"
fi

sh $ROOT_DIR/vendor/iprospect_ca/ip-codebase/src/Bash/Ci/Strata/build-common


# Run backend tests
# -----------------

if $ROOT_DIR/strata test; then
    echo "[strata-test-common] [ OK ] Backend tests succeeded."
else
    echo "[strata-test-common] [FAIL] Backend tests failed!" 1>&2
    exit 500
fi

# Run frontend tests
# ------------------

echo "[strata-test-common] [SKIP] Skipping forntend tests."

echo "[strata-test-common] Completed successfully."
